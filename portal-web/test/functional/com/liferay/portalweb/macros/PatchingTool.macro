definition {

	@summary = "Install the following patch onto Liferay Portal. ${patchFileZipURL}"
	macro installPatch {
		if (!(contains(${patchFileZipURL}, "dxp-0-"))) {
			AntCommands.runCommand("build-test.xml", "install-patch -Dpatch.file.zip.url=${patchFileZipURL}");
		}
		else {
			echo("No previous fix pack available to install");
		}
	}

	@summary = "Install the following patch onto Liferay Portal server with port ${nodePort}: ${patchFileZipURL}"
	macro installPatchOnSpecificServer {
		var leadingPortNumber = StringUtil.replace(${nodePort}, 080, "");

		var bundleIndex = ${leadingPortNumber} - 8;

		if (!(contains(${patchFileZipURL}, "dxp-0-"))) {
			AntCommands.runCommand("build-test.xml", "install-patch -Dinstall.patch.cluster.node.index=${bundleIndex} -Dpatch.file.zip.url=${patchFileZipURL}");
		}
		else {
			echo("No previous fix pack available to install");
		}
	}

	@summary = "Uninstall all patches from Liferay Portal."
	macro uninstallPatches {
		AntCommands.runCommand("build-test.xml", "uninstall-patches");
	}

	@summary = "Uninstall the following patch onto Liferay Portal server with port ${nodePort}"
	macro uninstallPatchOnSpecificServer {
		var leadingPortNumber = StringUtil.replace(${nodePort}, 080, "");

		var bundleIndex = ${leadingPortNumber} - 8;

		AntCommands.runCommand("build-test.xml", "uninstall-patches -Duninstall.patch.cluster.node.index=${bundleIndex}");
	}

	@summary = "Update the following osgi configuration onto Liferay Portal server with port ${nodePort}: ${updateConfiguration}"
	macro updateConfigurationOnSpecificServer {
		var leadingPortNumber = StringUtil.replace(${nodePort}, 080, "");

		var bundleIndex = ${leadingPortNumber} - 8;

		AntCommands.runCommand("build-test.xml", "update-osgi-module-configuration -Dinstall.patch.cluster.node.index=${bundleIndex} -Dupdate.configuration=\"${updateConfiguration}\"");
	}

}