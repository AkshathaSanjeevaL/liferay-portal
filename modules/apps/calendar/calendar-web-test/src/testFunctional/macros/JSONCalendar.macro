definition {

	macro setCalendarColor {
		var calendarId = JSONCalendarAPI.getCalendarId(calendarName = ${calendarName});

		if (!(isSet(color))) {
			var color = 14247526;
		}

		JSONCalendarAPI.updateColor(
			calendarId = ${calendarId},
			color = ${color});
	}

	macro tearDown {
		JSONCalendar.tearDownBookings();

		var calendarIdList = JSONCalendarAPI.getNotDefaultCalendars();

		for (var calendarId : list ${calendarIdList}) {
			JSONCalendarAPI.deleteCalendar(calendarId = ${calendarId});
		}
	}

	macro tearDownBookings {
		var calendarIdList = JSONCalendarAPI.searchAllCalendars();

		for (var calendarId : list ${calendarIdList}) {
			var calendarBookingIdList = JSONCalendarAPI.getCalendarBookings(calendarId = ${calendarId});

			for (var calendarBookingId : list ${calendarBookingIdList}) {
				JSONCalendarAPI.deleteCalendarBooking(calendarBookingId = ${calendarBookingId});
			}
		}
	}

}